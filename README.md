# robotin受注CSV変換ツール

robotinから出力されたCSVファイルを、指定フォーマットのExcelファイル（.xlsx）に変換するツールです。

## 機能

- robotin出力CSVから必要なカラムのみを抽出
- 実行日の日付を自動追加（M/D形式、例: 2/16）
- Excel形式で出力（書式設定済み）
- **複数回のCSV取り込み対応**（B列の値を指定可能）
- **データの統合とグループ化出力**
- Web版、GUI版、コマンドライン版の3種類を用意

## 出力フォーマット

以下の8カラムのExcelファイルを生成します：

1. **日付** - CSV取り込み日（実行日、M/D形式）
2. **メモ2** - B列の値（SC/倉庫/自社（複数）/自社（空欄）/佐川）※取り込み時に指定
   - 「自社（複数）」と「自社（空欄）」は出力時に空欄になります
3. **店舗名**
4. **商品名**
5. **配送先氏名**
6. **選択肢**
7. **単価**
8. **数量**

### 複数回取り込み機能

- 1日の作業で複数のCSVファイルを取り込み可能
- 各取り込み時にB列の値を指定（SC/倉庫/自社（複数）/自社/佐川）
- 最終出力時にB列の値でグループ化（SC→倉庫→自社（複数）→自社→佐川）
- グループ間に1行の空行を挿入
- 「自社（複数）」と「自社」は出力時に空欄になります

## 使い方

### Web版（最も簡単・推奨）

**インストール不要！ブラウザだけで動作**

1. `robotin_csv_converter_web.html` をブラウザで開く
2. B列の値を選択（SC/倉庫/自社（複数）/自社/佐川）
3. CSVファイルを選択して取り込み（複数回繰り返し可能）
4. すべてのデータを取り込んだら「Excelファイルをダウンロード」ボタンをクリック

**特徴：**
- ✅ Python不要、ブラウザだけで動作
- ✅ オフラインでも使用可能
- ✅ 直感的なUI
- ✅ データを一覧で確認・削除可能

### GUI版

ダブルクリックまたはコマンドラインから実行：

```bash
python robotin_csv_converter_gui.py
```

1. ファイル選択ダイアログが表示されます
2. robotin出力CSVファイルを選択
3. 保存先と出力ファイル名を指定
4. 変換完了のメッセージが表示されます

**注意：** GUI版は複数回取り込み機能に対応していません。1回のみの変換用です。

### コマンドライン版

```bash
# 基本的な使い方（出力ファイル名は自動生成）
python robotin_csv_converter_cli.py order_260216115444.csv

# 出力ファイル名を指定
python robotin_csv_converter_cli.py order_260216115444.csv output.xlsx
```

出力ファイル名を指定しない場合、入力ファイル名に`_converted.xlsx`が付加されます。
例: `order_260216115444.csv` → `order_260216115444_converted.xlsx`

**注意：** コマンドライン版は複数回取り込み機能に対応していません。1回のみの変換用です。

## 必要な環境

### Web版
- モダンなWebブラウザ（Chrome、Firefox、Edge、Safari等）
- **Python不要！**

### GUI版・コマンドライン版

- Python 3.6以上
- 必要なライブラリ:
  - pandas
  - openpyxl
  - tkinter（GUI版のみ、Windows/Macには標準でインストール済み）

## インストール

### Web版
インストール不要！`robotin_csv_converter_web.html`をブラウザで開くだけで使用できます。

### GUI版・コマンドライン版

```bash
pip install pandas openpyxl
```

## 動作例

### 入力ファイル（robotin出力CSV）
```
コントロールカラム,受注ID,店舗ID,店舗名,...,メモ2,明細ID,商品コード,商品名,選択肢,単価,数量,...
U,13205879,1310,HRS 楽天市場,...,,13205882,c240351dgy32,【商品名】,カラー:ダークグレーサイズ:32,2880,1,...
```

### 出力ファイル（Excel）
| 日付 | メモ2 | 店舗名 | 商品名 | 配送先氏名 | 選択肢 | 単価 | 数量 |
|------|-------|--------|--------|------------|--------|------|------|
| 2/16 | SC | HRS 楽天市場 | 【商品名】 | 光岡 正明 | カラー:ダークグレーサイズ:32 | 2880 | 1 |
|      |       |        |        |            |        |      |      |
| 2/16 | 倉庫 | ペット雑貨のasiato | 【商品名】 | 笠原 憲子 | カラー=三角帽... | 660 | 1 |
|      |       |        |        |            |        |      |      |
| 2/16 |      | HYS Yahoo!ショッピング | 【商品名】 | 田中 太郎 | カラー=レッド... | 1500 | 2 |
|      |       |        |        |            |        |      |      |
| 2/16 |      | XYZ ストア | 【商品名】 | 佐藤 花子 | サイズ=M... | 2000 | 1 |
|      |       |        |        |            |        |      |      |
| 2/16 | 佐川 | HYS Yahoo!ショッピング | 【商品名】 | 吉田 隆幸 | カラー=ブラック... | 1758 | 1 |

※ B列の値が変わる箇所（SC→倉庫→自社（複数）→自社→佐川）に空行が挿入されます  
※ 「自社（複数）」と「自社」はB列が空欄で出力されます

## トラブルシューティング

### Web版

**ファイルが正しく読み込めない**
- CSVファイルがShift-JISエンコーディングであることを確認してください
- ブラウザのコンソール（F12キー）でエラーメッセージを確認してください

**ダウンロードが始まらない**
- ブラウザのポップアップブロック設定を確認してください
- データが取り込まれているか確認してください

**古いブラウザを使用している場合**
- Chrome、Firefox、Edge、Safari等の最新版をご使用ください

### GUI版・コマンドライン版

**エラー: 必要なカラムが見つかりません**

robotin出力CSVに以下のカラムが存在することを確認してください：
- メモ2
- 店舗名
- 商品名
- 配送先氏名
- 選択肢
- 単価
- 数量

### 文字化けする場合

**Web版:** CSVファイルがShift-JISエンコーディングであることを確認してください。robotinの標準出力であれば問題ありません。

**GUI版・コマンドライン版:** 入力CSVファイルがShift-JISエンコーディングであることを確認してください。

### GUI版が起動しない

tkinterがインストールされていない可能性があります。
コマンドライン版を使用するか、以下でtkinterをインストールしてください：

**Ubuntu/Debian:**
```bash
sudo apt-get install python3-tk
```

**macOS:**
tkinterは標準でインストールされています。

**Windows:**
tkinterは標準でインストールされています。

## ライセンス

このツールは個人・商用問わず自由に使用できます。

## サポート

問題が発生した場合は、エラーメッセージと入力ファイルのカラム構成を確認してください。
